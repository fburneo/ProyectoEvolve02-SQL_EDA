/*
Objetivo:
  - Cargar los datos de /data (CSVs) en las tablas del esquema.
  - Script re-ejecutable: TRUNCATE + INSERT.
  - Incluir ejemplos requeridos: INSERT/UPDATE/DELETE + transacciones.
Notas:
  - Debes ejecutar, previamente, el archivosql/01_schema.sql.
  - IVA (21%) ya viene calculado en fact_rental (tax_amount/total_amount).
*/

BEGIN;

-- Limpieza para volver a cargar sin duplicados
TRUNCATE TABLE
  fact_rental,
  dim_customer,
  dim_motorcycle,
  dim_branch,
  dim_promo,
  dim_payment_method,
  dim_channel,
  dim_calendar,
  dim_province
RESTART IDENTITY CASCADE;

-- dim_province: 8 filas
INSERT INTO dim_province (province_id, province_name, autonomous_community)
VALUES
  (1, 'Girona', 'Cataluña'),
  (2, 'Barcelona', 'Cataluña'),
  (3, 'Madrid', 'Comunidad de Madrid'),
  (4, 'Valencia', 'Comunitat Valenciana'),
  (5, 'Málaga', 'Andalucía'),
  (6, 'Alicante', 'Comunitat Valenciana'),
  (7, 'Illes Balears', 'Illes Balears'),
  (8, 'Las Palmas', 'Canarias');

-- dim_calendar: 137 filas
INSERT INTO dim_calendar (date_key, date_value, day_of_month, month, year, day_name, month_name, is_weekend)
VALUES
  (20250601, '2025-06-01', 1, 6, 2025, 'Sunday', 'June', TRUE),
  (20250602, '2025-06-02', 2, 6, 2025, 'Monday', 'June', FALSE),
  (20250603, '2025-06-03', 3, 6, 2025, 'Tuesday', 'June', FALSE),
  (20250604, '2025-06-04', 4, 6, 2025, 'Wednesday', 'June', FALSE),
  (20250605, '2025-06-05', 5, 6, 2025, 'Thursday', 'June', FALSE),
  (20250606, '2025-06-06', 6, 6, 2025, 'Friday', 'June', FALSE),
  (20250607, '2025-06-07', 7, 6, 2025, 'Saturday', 'June', TRUE),
  (20250608, '2025-06-08', 8, 6, 2025, 'Sunday', 'June', TRUE),
  (20250609, '2025-06-09', 9, 6, 2025, 'Monday', 'June', FALSE),
  (20250610, '2025-06-10', 10, 6, 2025, 'Tuesday', 'June', FALSE),
  (20250611, '2025-06-11', 11, 6, 2025, 'Wednesday', 'June', FALSE),
  (20250612, '2025-06-12', 12, 6, 2025, 'Thursday', 'June', FALSE),
  (20250613, '2025-06-13', 13, 6, 2025, 'Friday', 'June', FALSE),
  (20250614, '2025-06-14', 14, 6, 2025, 'Saturday', 'June', TRUE),
  (20250615, '2025-06-15', 15, 6, 2025, 'Sunday', 'June', TRUE),
  (20250616, '2025-06-16', 16, 6, 2025, 'Monday', 'June', FALSE),
  (20250617, '2025-06-17', 17, 6, 2025, 'Tuesday', 'June', FALSE),
  (20250618, '2025-06-18', 18, 6, 2025, 'Wednesday', 'June', FALSE),
  (20250619, '2025-06-19', 19, 6, 2025, 'Thursday', 'June', FALSE),
  (20250620, '2025-06-20', 20, 6, 2025, 'Friday', 'June', FALSE),
  (20250621, '2025-06-21', 21, 6, 2025, 'Saturday', 'June', TRUE),
  (20250622, '2025-06-22', 22, 6, 2025, 'Sunday', 'June', TRUE),
  (20250623, '2025-06-23', 23, 6, 2025, 'Monday', 'June', FALSE),
  (20250624, '2025-06-24', 24, 6, 2025, 'Tuesday', 'June', FALSE),
  (20250625, '2025-06-25', 25, 6, 2025, 'Wednesday', 'June', FALSE),
  (20250626, '2025-06-26', 26, 6, 2025, 'Thursday', 'June', FALSE),
  (20250627, '2025-06-27', 27, 6, 2025, 'Friday', 'June', FALSE),
  (20250628, '2025-06-28', 28, 6, 2025, 'Saturday', 'June', TRUE),
  (20250629, '2025-06-29', 29, 6, 2025, 'Sunday', 'June', TRUE),
  (20250630, '2025-06-30', 30, 6, 2025, 'Monday', 'June', FALSE),
  (20250701, '2025-07-01', 1, 7, 2025, 'Tuesday', 'July', FALSE),
  (20250702, '2025-07-02', 2, 7, 2025, 'Wednesday', 'July', FALSE),
  (20250703, '2025-07-03', 3, 7, 2025, 'Thursday', 'July', FALSE),
  (20250704, '2025-07-04', 4, 7, 2025, 'Friday', 'July', FALSE),
  (20250705, '2025-07-05', 5, 7, 2025, 'Saturday', 'July', TRUE),
  (20250706, '2025-07-06', 6, 7, 2025, 'Sunday', 'July', TRUE),
  (20250707, '2025-07-07', 7, 7, 2025, 'Monday', 'July', FALSE),
  (20250708, '2025-07-08', 8, 7, 2025, 'Tuesday', 'July', FALSE),
  (20250709, '2025-07-09', 9, 7, 2025, 'Wednesday', 'July', FALSE),
  (20250710, '2025-07-10', 10, 7, 2025, 'Thursday', 'July', FALSE),
  (20250711, '2025-07-11', 11, 7, 2025, 'Friday', 'July', FALSE),
  (20250712, '2025-07-12', 12, 7, 2025, 'Saturday', 'July', TRUE),
  (20250713, '2025-07-13', 13, 7, 2025, 'Sunday', 'July', TRUE),
  (20250714, '2025-07-14', 14, 7, 2025, 'Monday', 'July', FALSE),
  (20250715, '2025-07-15', 15, 7, 2025, 'Tuesday', 'July', FALSE),
  (20250716, '2025-07-16', 16, 7, 2025, 'Wednesday', 'July', FALSE),
  (20250717, '2025-07-17', 17, 7, 2025, 'Thursday', 'July', FALSE),
  (20250718, '2025-07-18', 18, 7, 2025, 'Friday', 'July', FALSE),
  (20250719, '2025-07-19', 19, 7, 2025, 'Saturday', 'July', TRUE),
  (20250720, '2025-07-20', 20, 7, 2025, 'Sunday', 'July', TRUE),
  (20250721, '2025-07-21', 21, 7, 2025, 'Monday', 'July', FALSE),
  (20250722, '2025-07-22', 22, 7, 2025, 'Tuesday', 'July', FALSE),
  (20250723, '2025-07-23', 23, 7, 2025, 'Wednesday', 'July', FALSE),
  (20250724, '2025-07-24', 24, 7, 2025, 'Thursday', 'July', FALSE),
  (20250725, '2025-07-25', 25, 7, 2025, 'Friday', 'July', FALSE),
  (20250726, '2025-07-26', 26, 7, 2025, 'Saturday', 'July', TRUE),
  (20250727, '2025-07-27', 27, 7, 2025, 'Sunday', 'July', TRUE),
  (20250728, '2025-07-28', 28, 7, 2025, 'Monday', 'July', FALSE),
  (20250729, '2025-07-29', 29, 7, 2025, 'Tuesday', 'July', FALSE),
  (20250730, '2025-07-30', 30, 7, 2025, 'Wednesday', 'July', FALSE),
  (20250731, '2025-07-31', 31, 7, 2025, 'Thursday', 'July', FALSE),
  (20250801, '2025-08-01', 1, 8, 2025, 'Friday', 'August', FALSE),
  (20250802, '2025-08-02', 2, 8, 2025, 'Saturday', 'August', TRUE),
  (20250803, '2025-08-03', 3, 8, 2025, 'Sunday', 'August', TRUE),
  (20250804, '2025-08-04', 4, 8, 2025, 'Monday', 'August', FALSE),
  (20250805, '2025-08-05', 5, 8, 2025, 'Tuesday', 'August', FALSE),
  (20250806, '2025-08-06', 6, 8, 2025, 'Wednesday', 'August', FALSE),
  (20250807, '2025-08-07', 7, 8, 2025, 'Thursday', 'August', FALSE),
  (20250808, '2025-08-08', 8, 8, 2025, 'Friday', 'August', FALSE),
  (20250809, '2025-08-09', 9, 8, 2025, 'Saturday', 'August', TRUE),
  (20250810, '2025-08-10', 10, 8, 2025, 'Sunday', 'August', TRUE),
  (20250811, '2025-08-11', 11, 8, 2025, 'Monday', 'August', FALSE),
  (20250812, '2025-08-12', 12, 8, 2025, 'Tuesday', 'August', FALSE),
  (20250813, '2025-08-13', 13, 8, 2025, 'Wednesday', 'August', FALSE),
  (20250814, '2025-08-14', 14, 8, 2025, 'Thursday', 'August', FALSE),
  (20250815, '2025-08-15', 15, 8, 2025, 'Friday', 'August', FALSE),
  (20250816, '2025-08-16', 16, 8, 2025, 'Saturday', 'August', TRUE),
  (20250817, '2025-08-17', 17, 8, 2025, 'Sunday', 'August', TRUE),
  (20250818, '2025-08-18', 18, 8, 2025, 'Monday', 'August', FALSE),
  (20250819, '2025-08-19', 19, 8, 2025, 'Tuesday', 'August', FALSE),
  (20250820, '2025-08-20', 20, 8, 2025, 'Wednesday', 'August', FALSE),
  (20250821, '2025-08-21', 21, 8, 2025, 'Thursday', 'August', FALSE),
  (20250822, '2025-08-22', 22, 8, 2025, 'Friday', 'August', FALSE),
  (20250823, '2025-08-23', 23, 8, 2025, 'Saturday', 'August', TRUE),
  (20250824, '2025-08-24', 24, 8, 2025, 'Sunday', 'August', TRUE),
  (20250825, '2025-08-25', 25, 8, 2025, 'Monday', 'August', FALSE),
  (20250826, '2025-08-26', 26, 8, 2025, 'Tuesday', 'August', FALSE),
  (20250827, '2025-08-27', 27, 8, 2025, 'Wednesday', 'August', FALSE),
  (20250828, '2025-08-28', 28, 8, 2025, 'Thursday', 'August', FALSE),
  (20250829, '2025-08-29', 29, 8, 2025, 'Friday', 'August', FALSE),
  (20250830, '2025-08-30', 30, 8, 2025, 'Saturday', 'August', TRUE),
  (20250831, '2025-08-31', 31, 8, 2025, 'Sunday', 'August', TRUE),
  (20250901, '2025-09-01', 1, 9, 2025, 'Monday', 'September', FALSE),
  (20250902, '2025-09-02', 2, 9, 2025, 'Tuesday', 'September', FALSE),
  (20250903, '2025-09-03', 3, 9, 2025, 'Wednesday', 'September', FALSE),
  (20250904, '2025-09-04', 4, 9, 2025, 'Thursday', 'September', FALSE),
  (20250905, '2025-09-05', 5, 9, 2025, 'Friday', 'September', FALSE),
  (20250906, '2025-09-06', 6, 9, 2025, 'Saturday', 'September', TRUE),
  (20250907, '2025-09-07', 7, 9, 2025, 'Sunday', 'September', TRUE),
  (20250908, '2025-09-08', 8, 9, 2025, 'Monday', 'September', FALSE),
  (20250909, '2025-09-09', 9, 9, 2025, 'Tuesday', 'September', FALSE),
  (20250910, '2025-09-10', 10, 9, 2025, 'Wednesday', 'September', FALSE),
  (20250911, '2025-09-11', 11, 9, 2025, 'Thursday', 'September', FALSE),
  (20250912, '2025-09-12', 12, 9, 2025, 'Friday', 'September', FALSE),
  (20250913, '2025-09-13', 13, 9, 2025, 'Saturday', 'September', TRUE),
  (20250914, '2025-09-14', 14, 9, 2025, 'Sunday', 'September', TRUE),
  (20250915, '2025-09-15', 15, 9, 2025, 'Monday', 'September', FALSE),
  (20250916, '2025-09-16', 16, 9, 2025, 'Tuesday', 'September', FALSE),
  (20250917, '2025-09-17', 17, 9, 2025, 'Wednesday', 'September', FALSE),
  (20250918, '2025-09-18', 18, 9, 2025, 'Thursday', 'September', FALSE),
  (20250919, '2025-09-19', 19, 9, 2025, 'Friday', 'September', FALSE),
  (20250920, '2025-09-20', 20, 9, 2025, 'Saturday', 'September', TRUE),
  (20250921, '2025-09-21', 21, 9, 2025, 'Sunday', 'September', TRUE),
  (20250922, '2025-09-22', 22, 9, 2025, 'Monday', 'September', FALSE),
  (20250923, '2025-09-23', 23, 9, 2025, 'Tuesday', 'September', FALSE),
  (20250924, '2025-09-24', 24, 9, 2025, 'Wednesday', 'September', FALSE),
  (20250925, '2025-09-25', 25, 9, 2025, 'Thursday', 'September', FALSE),
  (20250926, '2025-09-26', 26, 9, 2025, 'Friday', 'September', FALSE),
  (20250927, '2025-09-27', 27, 9, 2025, 'Saturday', 'September', TRUE),
  (20250928, '2025-09-28', 28, 9, 2025, 'Sunday', 'September', TRUE),
  (20250929, '2025-09-29', 29, 9, 2025, 'Monday', 'September', FALSE),
  (20250930, '2025-09-30', 30, 9, 2025, 'Tuesday', 'September', FALSE),
  (20251001, '2025-10-01', 1, 10, 2025, 'Wednesday', 'October', FALSE),
  (20251002, '2025-10-02', 2, 10, 2025, 'Thursday', 'October', FALSE),
  (20251003, '2025-10-03', 3, 10, 2025, 'Friday', 'October', FALSE),
  (20251004, '2025-10-04', 4, 10, 2025, 'Saturday', 'October', TRUE),
  (20251005, '2025-10-05', 5, 10, 2025, 'Sunday', 'October', TRUE),
  (20251006, '2025-10-06', 6, 10, 2025, 'Monday', 'October', FALSE),
  (20251007, '2025-10-07', 7, 10, 2025, 'Tuesday', 'October', FALSE),
  (20251008, '2025-10-08', 8, 10, 2025, 'Wednesday', 'October', FALSE),
  (20251009, '2025-10-09', 9, 10, 2025, 'Thursday', 'October', FALSE),
  (20251010, '2025-10-10', 10, 10, 2025, 'Friday', 'October', FALSE),
  (20251011, '2025-10-11', 11, 10, 2025, 'Saturday', 'October', TRUE),
  (20251012, '2025-10-12', 12, 10, 2025, 'Sunday', 'October', TRUE),
  (20251013, '2025-10-13', 13, 10, 2025, 'Monday', 'October', FALSE),
  (20251014, '2025-10-14', 14, 10, 2025, 'Tuesday', 'October', FALSE),
  (20251015, '2025-10-15', 15, 10, 2025, 'Wednesday', 'October', FALSE);

-- dim_channel: 5 filas
INSERT INTO dim_channel (channel_id, channel_name)
VALUES
  (1, 'Wix Website'),
  (2, 'Walk-in'),
  (3, 'WhatsApp'),
  (4, 'Partner OTA'),
  (5, 'Phone');

-- dim_payment_method: 4 filas
INSERT INTO dim_payment_method (payment_method_id, method_name)
VALUES
  (1, 'Stripe Card'),
  (2, 'Stripe Link'),
  (3, 'Cash'),
  (4, 'Bank Transfer');

-- dim_promo: 3 filas
INSERT INTO dim_promo (promo_id, code, discount_type, discount_value, description)
VALUES
  (1, 'SUMMER10', 'percent', 10.0, '10% descuento verano'),
  (2, 'WEEKLY25', 'fixed', 25.0, '25€ descuento semanal'),
  (3, 'FRIENDS15', 'percent', 15.0, '15% referidos/amigos');

-- dim_branch: 5 filas
INSERT INTO dim_branch (branch_id, branch_name, city, province_id, address, timezone)
VALUES
  (1, 'Girona Centro', 'Girona', 1, 'C/ Gran Via 10, 17001 Girona', 'Europe/Madrid'),
  (2, 'Girona Aeropuerto', 'Vilobí d''Onyar', 1, 'Terminal Llegadas, 17185 Girona', 'Europe/Madrid'),
  (3, 'Barcelona Sants', 'Barcelona', 2, 'Plaça dels Països Catalans, 08014 Barcelona', 'Europe/Madrid'),
  (4, 'Valencia Centro', 'Valencia', 4, 'C/ Xàtiva 1, 46002 Valencia', 'Europe/Madrid'),
  (5, 'Málaga Aeropuerto', 'Málaga', 5, 'Av. del Comandante García Morato, 29004 Málaga', 'Europe/Madrid');

-- dim_motorcycle: 20 filas
INSERT INTO dim_motorcycle (motorcycle_id, plate, brand, model, category, engine_cc, model_year, color, has_gps, status)
VALUES
  (1, '123BIO', 'Honda', 'PCX', 'scooter', 125, 2019, 'White', TRUE, 'available'),
  (2, '123CJP', 'Honda', 'PCX', 'scooter', 125, 2020, 'Red', TRUE, 'available'),
  (3, '123DKQ', 'Honda', 'PCX', 'scooter', 125, 2021, 'Blue', TRUE, 'available'),
  (4, '123ELR', 'Honda', 'PCX', 'scooter', 125, 2022, 'Grey', TRUE, 'available'),
  (5, '123FMS', 'Honda', 'PCX', 'scooter', 155, 2023, 'Black', TRUE, 'available'),
  (6, '123GNT', 'Yamaha', 'NMAX', 'scooter', 155, 2024, 'White', TRUE, 'available'),
  (7, '123HOU', 'Yamaha', 'NMAX', 'scooter', 155, 2018, 'Red', TRUE, 'available'),
  (8, '123IPV', 'Yamaha', 'NMAX', 'scooter', 155, 2019, 'Blue', TRUE, 'available'),
  (9, '123JQW', 'Yamaha', 'NMAX', 'scooter', 300, 2020, 'Grey', TRUE, 'available'),
  (10, '123KRX', 'Yamaha', 'NMAX', 'scooter', 300, 2021, 'Black', TRUE, 'available'),
  (11, '123LSY', 'Piaggio', 'Vespa Primavera', 'scooter', 300, 2022, 'White', TRUE, 'available'),
  (12, '123MTZ', 'Piaggio', 'Vespa Primavera', 'scooter', 300, 2023, 'Red', TRUE, 'available'),
  (13, '123NUA', 'Piaggio', 'Vespa Primavera', 'manual', 500, 2024, 'Blue', TRUE, 'available'),
  (14, '123OVB', 'Piaggio', 'Vespa Primavera', 'manual', 500, 2018, 'Grey', TRUE, 'available'),
  (15, '123PWC', 'Kymco', 'Agility', 'manual', 500, 2019, 'Black', TRUE, 'available'),
  (16, '123QXD', 'Kymco', 'Agility', 'manual', 500, 2020, 'White', TRUE, 'available'),
  (17, '123RYE', 'Kymco', 'Agility', 'manual', 313, 2021, 'Red', TRUE, 'available'),
  (18, '123SZF', 'BMW', 'G 310 GS', 'manual', 313, 2022, 'Blue', TRUE, 'available'),
  (19, '123TAG', 'BMW', 'G 310 GS', 'manual', 313, 2023, 'Grey', TRUE, 'maintenance'),
  (20, '123UBH', 'BMW', 'G 310 GS', 'manual', 313, 2024, 'Black', TRUE, 'available');

-- dim_customer: 50 filas
INSERT INTO dim_customer (customer_id, first_name, last_name, email, phone, nationality, is_tourist, created_date_key)
VALUES
  (1, 'Name1', 'Surname1', 'customer1@example.com', '+34 610000001', 'ES', FALSE, 20250602),
  (2, 'Name2', 'Surname2', 'customer2@example.com', '+34 610000002', 'ES', FALSE, 20250603),
  (3, 'Name3', 'Surname3', 'customer3@example.com', '+34 610000003', 'ES', FALSE, 20250604),
  (4, 'Name4', 'Surname4', 'customer4@example.com', '+34 610000004', 'FR', TRUE, 20250605),
  (5, 'Name5', 'Surname5', 'customer5@example.com', '+34 610000005', 'FR', TRUE, 20250606),
  (6, 'Name6', 'Surname6', 'customer6@example.com', '+34 610000006', 'DE', TRUE, 20250607),
  (7, 'Name7', 'Surname7', 'customer7@example.com', '+34 610000007', 'DE', TRUE, 20250608),
  (8, 'Name8', 'Surname8', 'customer8@example.com', '+34 610000008', 'IT', TRUE, 20250609),
  (9, 'Name9', 'Surname9', 'customer9@example.com', '+34 610000009', 'IT', TRUE, 20250610),
  (10, 'Name10', 'Surname10', 'customer10@example.com', '+34 610000010', 'ES', FALSE, 20250611),
  (11, 'Name11', 'Surname11', 'customer11@example.com', '+34 610000011', 'ES', FALSE, 20250612),
  (12, 'Name12', 'Surname12', 'customer12@example.com', '+34 610000012', 'ES', FALSE, 20250613),
  (13, 'Name13', 'Surname13', 'customer13@example.com', '+34 610000013', 'ES', FALSE, 20250614),
  (14, 'Name14', 'Surname14', 'customer14@example.com', '+34 610000014', 'FR', TRUE, 20250615),
  (15, 'Name15', 'Surname15', 'customer15@example.com', '+34 610000015', 'FR', TRUE, 20250616),
  (16, 'Name16', 'Surname16', 'customer16@example.com', '+34 610000016', 'DE', TRUE, 20250617),
  (17, 'Name17', 'Surname17', 'customer17@example.com', '+34 610000017', 'DE', TRUE, 20250618),
  (18, 'Name18', 'Surname18', 'customer18@example.com', '+34 610000018', 'IT', TRUE, 20250619),
  (19, 'Name19', 'Surname19', 'customer19@example.com', '+34 610000019', 'IT', TRUE, 20250620),
  (20, 'Name20', 'Surname20', 'customer20@example.com', '+34 610000020', 'ES', FALSE, 20250621),
  (21, 'Name21', 'Surname21', 'customer21@example.com', '+34 610000021', 'ES', FALSE, 20250622),
  (22, 'Name22', 'Surname22', 'customer22@example.com', '+34 610000022', 'ES', FALSE, 20250623),
  (23, 'Name23', 'Surname23', 'customer23@example.com', '+34 610000023', 'ES', FALSE, 20250624),
  (24, 'Name24', 'Surname24', 'customer24@example.com', '+34 610000024', 'FR', TRUE, 20250625),
  (25, 'Name25', 'Surname25', 'customer25@example.com', '+34 610000025', 'FR', TRUE, 20250626),
  (26, 'Name26', 'Surname26', 'customer26@example.com', '+34 610000026', 'DE', TRUE, 20250627),
  (27, 'Name27', 'Surname27', 'customer27@example.com', '+34 610000027', 'DE', TRUE, 20250628),
  (28, 'Name28', 'Surname28', 'customer28@example.com', '+34 610000028', 'IT', TRUE, 20250629),
  (29, 'Name29', 'Surname29', 'customer29@example.com', '+34 610000029', 'IT', TRUE, 20250630),
  (30, 'Name30', 'Surname30', 'customer30@example.com', '+34 610000030', 'ES', FALSE, 20250601),
  (31, 'Name31', 'Surname31', 'customer31@example.com', '+34 610000031', 'ES', FALSE, 20250602),
  (32, 'Name32', 'Surname32', 'customer32@example.com', '+34 610000032', 'ES', FALSE, 20250603),
  (33, 'Name33', 'Surname33', 'customer33@example.com', '+34 610000033', 'ES', FALSE, 20250604),
  (34, 'Name34', 'Surname34', 'customer34@example.com', '+34 610000034', 'FR', TRUE, 20250605),
  (35, 'Name35', 'Surname35', 'customer35@example.com', '+34 610000035', 'FR', TRUE, 20250606),
  (36, 'Name36', 'Surname36', 'customer36@example.com', '+34 610000036', 'DE', TRUE, 20250607),
  (37, 'Name37', 'Surname37', 'customer37@example.com', '+34 610000037', 'DE', TRUE, 20250608),
  (38, 'Name38', 'Surname38', 'customer38@example.com', '+34 610000038', 'IT', TRUE, 20250609),
  (39, 'Name39', 'Surname39', 'customer39@example.com', '+34 610000039', 'IT', TRUE, 20250610),
  (40, 'Name40', 'Surname40', 'customer40@example.com', '+34 610000040', 'ES', FALSE, 20250611),
  (41, 'Name41', 'Surname41', 'customer41@example.com', '+34 610000041', 'ES', FALSE, 20250612),
  (42, 'Name42', 'Surname42', 'customer42@example.com', '+34 610000042', 'ES', FALSE, 20250613),
  (43, 'Name43', 'Surname43', 'customer43@example.com', '+34 610000043', 'ES', FALSE, 20250614),
  (44, 'Name44', 'Surname44', 'customer44@example.com', '+34 610000044', 'FR', TRUE, 20250615),
  (45, 'Name45', 'Surname45', 'customer45@example.com', '+34 610000045', 'FR', TRUE, 20250616),
  (46, 'Name46', 'Surname46', 'customer46@example.com', '+34 610000046', 'DE', TRUE, 20250617),
  (47, 'Name47', 'Surname47', 'customer47@example.com', '+34 610000047', 'DE', TRUE, 20250618),
  (48, 'Name48', 'Surname48', 'customer48@example.com', '+34 610000048', 'IT', TRUE, 20250619),
  (49, 'Name49', 'Surname49', 'customer49@example.com', '+34 610000049', 'IT', TRUE, 20250620),
  (50, 'Name50', 'Surname50', 'customer50@example.com', '+34 610000050', 'ES', FALSE, 20250621);

-- fact_rental: 160 filas
INSERT INTO fact_rental (rental_id, booking_reference, customer_id, motorcycle_id, branch_pickup_id, branch_return_id, channel_id, payment_method_id, promo_id, booking_date_key, pickup_date_key, return_date_key, rental_days, daily_rate, subtotal, discount_amount, tax_amount, total_amount, deposit_amount, deposit_status, damage_fee, traffic_fines, status, created_at)
VALUES
  (1, 'RB000001', 2, 2, 2, 3, 2, 2, NULL, 20250609, 20250611, 20250613, 2, 65, 130, 0.0, 27.3, 157.3, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-30 12:00:00'),
  (2, 'RB000002', 3, 3, 3, 4, 3, 3, NULL, 20250609, 20250612, 20250615, 3, 70, 210, 0.0, 44.1, 254.1, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-29 12:00:00'),
  (3, 'RB000003', 4, 4, 4, 5, 4, 4, NULL, 20250609, 20250613, 20250617, 4, 75, 300, 0.0, 63.0, 363.0, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-28 12:00:00'),
  (4, 'RB000004', 5, 5, 5, 1, 5, 1, NULL, 20250609, 20250614, 20250619, 5, 80, 400, 0.0, 84.0, 484.0, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-27 12:00:00'),
  (5, 'RB000005', 6, 6, 1, 2, 1, 2, NULL, 20250609, 20250615, 20250621, 6, 55, 330, 0.0, 69.3, 399.3, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-26 12:00:00'),
  (6, 'RB000006', 7, 7, 2, 3, 2, 3, NULL, 20250609, 20250616, 20250623, 7, 60, 420, 0.0, 88.2, 508.2, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-25 12:00:00'),
  (7, 'RB000007', 8, 8, 3, 4, 3, 4, 2, 20250609, 20250617, 20250625, 8, 65, 520, 25.0, 103.95, 598.95, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-24 12:00:00'),
  (8, 'RB000008', 9, 9, 4, 5, 4, 1, NULL, 20250609, 20250618, 20250627, 9, 70, 630, 0.0, 132.3, 762.3, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-23 12:00:00'),
  (9, 'RB000009', 10, 10, 5, 1, 5, 2, NULL, 20250609, 20250619, 20250629, 10, 75, 750, 0.0, 157.5, 907.5, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-22 12:00:00'),
  (10, 'RB000010', 11, 11, 1, 2, 1, 3, NULL, 20250609, 20250620, 20250701, 11, 80, 880, 0.0, 184.8, 1064.8, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-21 12:00:00'),
  (11, 'RB000011', 12, 12, 2, 3, 2, 4, NULL, 20250609, 20250621, 20250703, 12, 55, 660, 0.0, 138.6, 798.6, 300.0, 'held', 0.0, 0.0, 'active', '2025-09-20 12:00:00'),
  (12, 'RB000012', 13, 13, 3, 4, 3, 1, NULL, 20250609, 20250622, 20250705, 13, 92, 1196, 0.0, 251.16, 1447.16, 500.0, 'released', 0.0, 0.0, 'completed', '2025-09-19 12:00:00'),
  (13, 'RB000013', 14, 14, 4, 5, 4, 2, NULL, 20250609, 20250623, 20250707, 14, 99, 1386, 0.0, 291.06, 1677.06, 500.0, 'released', 0.0, 0.0, 'completed', '2025-09-18 12:00:00'),
  (14, 'RB000014', 15, 15, 5, 1, 5, 3, 3, 20250623, 20250624, 20250625, 1, 106, 106, 15.9, 18.92, 109.02, 500.0, 'released', 0.0, 0.0, 'completed', '2025-09-17 12:00:00'),
  (15, 'RB000015', 16, 16, 1, 2, 1, 4, NULL, 20250623, 20250625, 20250627, 2, 113, 226, 0.0, 47.46, 273.46, 500.0, 'released', 0.0, 0.0, 'completed', '2025-09-16 12:00:00'),
  (16, 'RB000016', 17, 17, 2, 3, 2, 1, NULL, 20250623, 20250626, 20250629, 3, 120, 360, 0.0, 75.6, 435.6, 500.0, 'released', 0.0, 0.0, 'completed', '2025-09-15 12:00:00'),
  (17, 'RB000017', 18, 18, 3, 4, 3, 2, NULL, 20250623, 20250627, 20250701, 4, 85, 340, 0.0, 71.4, 411.4, 500.0, 'partially_used', 115.0, 0.0, 'completed', '2025-09-14 12:00:00'),
  (18, 'RB000018', 19, 19, 4, 5, 4, 3, NULL, 20250623, 20250628, 20250703, 5, 92, 460, 0.0, 96.6, 556.6, 500.0, 'released', 0.0, 0.0, 'completed', '2025-09-13 12:00:00'),
  (19, 'RB000019', 20, 20, 5, 1, 5, 4, NULL, 20250623, 20250629, 20250705, 6, 99, 594, 0.0, 124.74, 718.74, 500.0, 'released', 0.0, 0.0, 'completed', '2025-09-12 12:00:00'),
  (20, 'RB000020', 21, 1, 1, 2, 1, 1, NULL, 20250623, 20250630, 20250707, 7, 60, 420, 0.0, 88.2, 508.2, 300.0, 'held', 0.0, 0.0, 'cancelled', '2025-09-11 12:00:00'),
  (21, 'RB000021', 22, 2, 2, 3, 2, 2, 1, 20250623, 20250701, 20250709, 8, 65, 520, 52.0, 98.28, 566.28, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-10 12:00:00'),
  (22, 'RB000022', 23, 3, 3, 4, 3, 3, NULL, 20250623, 20250702, 20250711, 9, 70, 630, 0.0, 132.3, 762.3, 300.0, 'held', 0.0, 0.0, 'active', '2025-09-09 12:00:00'),
  (23, 'RB000023', 24, 4, 4, 5, 4, 4, NULL, 20250623, 20250703, 20250713, 10, 75, 750, 0.0, 157.5, 907.5, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-08 12:00:00'),
  (24, 'RB000024', 25, 5, 5, 1, 5, 1, NULL, 20250623, 20250704, 20250715, 11, 80, 880, 0.0, 184.8, 1064.8, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-07 12:00:00'),
  (25, 'RB000025', 26, 6, 1, 2, 1, 2, NULL, 20250623, 20250705, 20250717, 12, 55, 660, 0.0, 138.6, 798.6, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-06 12:00:00'),
  (26, 'RB000026', 27, 7, 2, 3, 2, 3, NULL, 20250623, 20250706, 20250719, 13, 60, 780, 0.0, 163.8, 943.8, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-05 12:00:00'),
  (27, 'RB000027', 28, 8, 3, 4, 3, 4, NULL, 20250623, 20250707, 20250721, 14, 65, 910, 0.0, 191.1, 1101.1, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-04 12:00:00'),
  (28, 'RB000028', 29, 9, 4, 5, 4, 1, 2, 20250707, 20250708, 20250709, 1, 70, 70, 21.0, 10.29, 59.29, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-03 12:00:00'),
  (29, 'RB000029', 30, 10, 5, 1, 5, 2, NULL, 20250707, 20250709, 20250711, 2, 75, 150, 0.0, 31.5, 181.5, 300.0, 'partially_used', 0.0, 90.0, 'completed', '2025-09-02 12:00:00'),
  (30, 'RB000030', 31, 11, 1, 2, 1, 3, NULL, 20250707, 20250710, 20250713, 3, 80, 240, 0.0, 50.4, 290.4, 300.0, 'released', 0.0, 0.0, 'completed', '2025-09-01 12:00:00'),
  (31, 'RB000031', 32, 12, 2, 3, 2, 4, NULL, 20250707, 20250711, 20250715, 4, 55, 220, 0.0, 46.2, 266.2, 300.0, 'released', 0.0, 0.0, 'completed', '2025-08-31 12:00:00'),
  (32, 'RB000032', 33, 13, 3, 4, 3, 1, NULL, 20250707, 20250712, 20250717, 5, 92, 460, 0.0, 96.6, 556.6, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-30 12:00:00'),
  (33, 'RB000033', 34, 14, 4, 5, 4, 2, NULL, 20250707, 20250713, 20250719, 6, 99, 594, 0.0, 124.74, 718.74, 500.0, 'held', 0.0, 0.0, 'no_show', '2025-08-29 12:00:00'),
  (34, 'RB000034', 35, 15, 5, 1, 5, 3, NULL, 20250707, 20250714, 20250721, 7, 106, 742, 0.0, 155.82, 897.82, 500.0, 'partially_used', 80.0, 0.0, 'completed', '2025-08-28 12:00:00'),
  (35, 'RB000035', 36, 16, 1, 2, 1, 4, 3, 20250707, 20250715, 20250723, 8, 113, 904, 135.6, 161.36, 929.76, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-27 12:00:00'),
  (36, 'RB000036', 37, 17, 2, 3, 2, 1, NULL, 20250707, 20250716, 20250725, 9, 120, 1080, 0.0, 226.8, 1306.8, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-26 12:00:00'),
  (37, 'RB000037', 38, 18, 3, 4, 3, 2, NULL, 20250707, 20250717, 20250727, 10, 85, 850, 0.0, 178.5, 1028.5, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-25 12:00:00'),
  (38, 'RB000038', 39, 19, 4, 5, 4, 3, NULL, 20250707, 20250718, 20250729, 11, 92, 1012, 0.0, 212.52, 1224.52, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-24 12:00:00'),
  (39, 'RB000039', 40, 20, 5, 1, 5, 4, NULL, 20250707, 20250719, 20250731, 12, 99, 1188, 0.0, 249.48, 1437.48, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-23 12:00:00'),
  (40, 'RB000040', 41, 1, 1, 2, 1, 1, NULL, 20250707, 20250720, 20250802, 13, 60, 780, 0.0, 163.8, 943.8, 300.0, 'held', 0.0, 0.0, 'cancelled', '2025-08-22 12:00:00'),
  (41, 'RB000041', 42, 2, 2, 3, 2, 2, NULL, 20250707, 20250721, 20250804, 14, 65, 910, 0.0, 191.1, 1101.1, 300.0, 'released', 0.0, 0.0, 'completed', '2025-08-21 12:00:00'),
  (42, 'RB000042', 43, 3, 3, 4, 3, 3, 1, 20250721, 20250722, 20250723, 1, 70, 70, 7.0, 13.23, 76.23, 300.0, 'released', 0.0, 0.0, 'completed', '2025-08-20 12:00:00'),
  (43, 'RB000043', 44, 4, 4, 5, 4, 4, NULL, 20250721, 20250723, 20250725, 2, 75, 150, 0.0, 31.5, 181.5, 300.0, 'released', 0.0, 0.0, 'completed', '2025-08-19 12:00:00'),
  (44, 'RB000044', 45, 5, 5, 1, 5, 1, NULL, 20250721, 20250724, 20250727, 3, 80, 240, 0.0, 50.4, 290.4, 300.0, 'held', 0.0, 0.0, 'active', '2025-08-18 12:00:00'),
  (45, 'RB000045', 46, 6, 1, 2, 1, 2, NULL, 20250721, 20250725, 20250729, 4, 55, 220, 0.0, 46.2, 266.2, 300.0, 'released', 0.0, 0.0, 'completed', '2025-08-17 12:00:00'),
  (46, 'RB000046', 47, 7, 2, 3, 2, 3, NULL, 20250721, 20250726, 20250731, 5, 60, 300, 0.0, 63.0, 363.0, 300.0, 'released', 0.0, 0.0, 'completed', '2025-08-16 12:00:00'),
  (47, 'RB000047', 48, 8, 3, 4, 3, 4, NULL, 20250721, 20250727, 20250802, 6, 65, 390, 0.0, 81.9, 471.9, 300.0, 'released', 0.0, 0.0, 'completed', '2025-08-15 12:00:00'),
  (48, 'RB000048', 49, 9, 4, 5, 4, 1, NULL, 20250721, 20250728, 20250804, 7, 70, 490, 0.0, 102.9, 592.9, 300.0, 'released', 0.0, 0.0, 'completed', '2025-08-14 12:00:00'),
  (49, 'RB000049', 50, 10, 5, 1, 5, 2, 2, 20250721, 20250729, 20250806, 8, 75, 600, 25.0, 120.75, 695.75, 300.0, 'released', 0.0, 0.0, 'completed', '2025-08-13 12:00:00'),
  (50, 'RB000050', 1, 11, 1, 2, 1, 3, NULL, 20250721, 20250730, 20250808, 9, 80, 720, 0.0, 151.2, 871.2, 300.0, 'released', 0.0, 0.0, 'completed', '2025-08-12 12:00:00'),
  (51, 'RB000051', 2, 12, 2, 3, 2, 4, NULL, 20250721, 20250731, 20250810, 10, 55, 550, 0.0, 115.5, 665.5, 300.0, 'partially_used', 45.0, 0.0, 'completed', '2025-08-11 12:00:00'),
  (52, 'RB000052', 3, 13, 3, 4, 3, 1, NULL, 20250721, 20250801, 20250812, 11, 92, 1012, 0.0, 212.52, 1224.52, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-10 12:00:00'),
  (53, 'RB000053', 4, 14, 4, 5, 4, 2, NULL, 20250721, 20250802, 20250814, 12, 99, 1188, 0.0, 249.48, 1437.48, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-09 12:00:00'),
  (54, 'RB000054', 5, 15, 5, 1, 5, 3, NULL, 20250721, 20250803, 20250816, 13, 106, 1378, 0.0, 289.38, 1667.38, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-08 12:00:00'),
  (55, 'RB000055', 6, 16, 1, 2, 1, 4, NULL, 20250721, 20250804, 20250818, 14, 113, 1582, 0.0, 332.22, 1914.22, 500.0, 'held', 0.0, 0.0, 'active', '2025-08-07 12:00:00'),
  (56, 'RB000056', 7, 17, 2, 3, 2, 1, 3, 20250804, 20250805, 20250806, 1, 120, 120, 18.0, 21.42, 123.42, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-06 12:00:00'),
  (57, 'RB000057', 8, 18, 3, 4, 3, 2, NULL, 20250804, 20250806, 20250808, 2, 85, 170, 0.0, 35.7, 205.7, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-05 12:00:00'),
  (58, 'RB000058', 9, 19, 4, 5, 4, 3, NULL, 20250804, 20250807, 20250810, 3, 92, 276, 0.0, 57.96, 333.96, 500.0, 'partially_used', 0.0, 90.0, 'completed', '2025-08-04 12:00:00'),
  (59, 'RB000059', 10, 20, 5, 1, 5, 4, NULL, 20250804, 20250808, 20250812, 4, 99, 396, 0.0, 83.16, 479.16, 500.0, 'released', 0.0, 0.0, 'completed', '2025-08-03 12:00:00'),
  (60, 'RB000060', 11, 1, 1, 2, 1, 1, NULL, 20250804, 20250809, 20250814, 5, 60, 300, 0.0, 63.0, 363.0, 300.0, 'held', 0.0, 0.0, 'cancelled', '2025-08-02 12:00:00'),
  (61, 'RB000061', 12, 2, 2, 3, 2, 2, NULL, 20250804, 20250810, 20250816, 6, 65, 390, 0.0, 81.9, 471.9, 300.0, 'released', 0.0, 0.0, 'completed', '2025-08-01 12:00:00'),
  (62, 'RB000062', 13, 3, 3, 4, 3, 3, NULL, 20250804, 20250811, 20250818, 7, 70, 490, 0.0, 102.9, 592.9, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-31 12:00:00'),
  (63, 'RB000063', 14, 4, 4, 5, 4, 4, 1, 20250804, 20250812, 20250820, 8, 75, 600, 60.0, 113.4, 653.4, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-30 12:00:00'),
  (64, 'RB000064', 15, 5, 5, 1, 5, 1, NULL, 20250804, 20250813, 20250822, 9, 80, 720, 0.0, 151.2, 871.2, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-29 12:00:00'),
  (65, 'RB000065', 16, 6, 1, 2, 1, 2, NULL, 20250804, 20250814, 20250824, 10, 55, 550, 0.0, 115.5, 665.5, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-28 12:00:00'),
  (66, 'RB000066', 17, 7, 2, 3, 2, 3, NULL, 20250804, 20250815, 20250826, 11, 60, 660, 0.0, 138.6, 798.6, 300.0, 'held', 0.0, 0.0, 'no_show', '2025-07-27 12:00:00'),
  (67, 'RB000067', 18, 8, 3, 4, 3, 4, NULL, 20250804, 20250816, 20250828, 12, 65, 780, 0.0, 163.8, 943.8, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-26 12:00:00'),
  (68, 'RB000068', 19, 9, 4, 5, 4, 1, NULL, 20250804, 20250817, 20250830, 13, 70, 910, 0.0, 191.1, 1101.1, 300.0, 'partially_used', 115.0, 0.0, 'completed', '2025-07-25 12:00:00'),
  (69, 'RB000069', 20, 10, 5, 1, 5, 2, NULL, 20250804, 20250818, 20250901, 14, 75, 1050, 0.0, 220.5, 1270.5, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-24 12:00:00'),
  (70, 'RB000070', 21, 11, 1, 2, 1, 3, 2, 20250818, 20250819, 20250820, 1, 80, 80, 24.0, 11.76, 67.76, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-23 12:00:00'),
  (71, 'RB000071', 22, 12, 2, 3, 2, 4, NULL, 20250818, 20250820, 20250822, 2, 55, 110, 0.0, 23.1, 133.1, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-22 12:00:00'),
  (72, 'RB000072', 23, 13, 3, 4, 3, 1, NULL, 20250818, 20250821, 20250824, 3, 92, 276, 0.0, 57.96, 333.96, 500.0, 'released', 0.0, 0.0, 'completed', '2025-07-21 12:00:00'),
  (73, 'RB000073', 24, 14, 4, 5, 4, 2, NULL, 20250818, 20250822, 20250826, 4, 99, 396, 0.0, 83.16, 479.16, 500.0, 'released', 0.0, 0.0, 'completed', '2025-07-20 12:00:00'),
  (74, 'RB000074', 25, 15, 5, 1, 5, 3, NULL, 20250818, 20250823, 20250828, 5, 106, 530, 0.0, 111.3, 641.3, 500.0, 'released', 0.0, 0.0, 'completed', '2025-07-19 12:00:00'),
  (75, 'RB000075', 26, 16, 1, 2, 1, 4, NULL, 20250818, 20250824, 20250830, 6, 113, 678, 0.0, 142.38, 820.38, 500.0, 'released', 0.0, 0.0, 'completed', '2025-07-18 12:00:00'),
  (76, 'RB000076', 27, 17, 2, 3, 2, 1, NULL, 20250818, 20250825, 20250901, 7, 120, 840, 0.0, 176.4, 1016.4, 500.0, 'released', 0.0, 0.0, 'completed', '2025-07-17 12:00:00'),
  (77, 'RB000077', 28, 18, 3, 4, 3, 2, 3, 20250818, 20250826, 20250903, 8, 85, 680, 102.0, 121.38, 699.38, 500.0, 'held', 0.0, 0.0, 'active', '2025-07-16 12:00:00'),
  (78, 'RB000078', 29, 19, 4, 5, 4, 3, NULL, 20250818, 20250827, 20250905, 9, 92, 828, 0.0, 173.88, 1001.88, 500.0, 'released', 0.0, 0.0, 'completed', '2025-07-15 12:00:00'),
  (79, 'RB000079', 30, 20, 5, 1, 5, 4, NULL, 20250818, 20250828, 20250907, 10, 99, 990, 0.0, 207.9, 1197.9, 500.0, 'released', 0.0, 0.0, 'completed', '2025-07-14 12:00:00'),
  (80, 'RB000080', 31, 1, 1, 2, 1, 1, NULL, 20250818, 20250829, 20250909, 11, 60, 660, 0.0, 138.6, 798.6, 300.0, 'held', 0.0, 0.0, 'cancelled', '2025-07-13 12:00:00'),
  (81, 'RB000081', 32, 2, 2, 3, 2, 2, NULL, 20250818, 20250830, 20250911, 12, 65, 780, 0.0, 163.8, 943.8, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-12 12:00:00'),
  (82, 'RB000082', 33, 3, 3, 4, 3, 3, NULL, 20250818, 20250831, 20250913, 13, 70, 910, 0.0, 191.1, 1101.1, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-11 12:00:00'),
  (83, 'RB000083', 34, 4, 4, 5, 4, 4, NULL, 20250818, 20250901, 20250915, 14, 75, 1050, 0.0, 220.5, 1270.5, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-10 12:00:00'),
  (84, 'RB000084', 35, 5, 5, 1, 5, 1, 1, 20250901, 20250902, 20250903, 1, 80, 80, 8.0, 15.12, 87.12, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-09 12:00:00'),
  (85, 'RB000085', 36, 6, 1, 2, 1, 2, NULL, 20250901, 20250903, 20250905, 2, 55, 110, 0.0, 23.1, 133.1, 300.0, 'partially_used', 80.0, 0.0, 'completed', '2025-07-08 12:00:00'),
  (86, 'RB000086', 37, 7, 2, 3, 2, 3, NULL, 20250901, 20250904, 20250907, 3, 60, 180, 0.0, 37.8, 217.8, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-07 12:00:00'),
  (87, 'RB000087', 38, 8, 3, 4, 3, 4, NULL, 20250901, 20250905, 20250909, 4, 65, 260, 0.0, 54.6, 314.6, 300.0, 'partially_used', 0.0, 90.0, 'completed', '2025-07-06 12:00:00'),
  (88, 'RB000088', 39, 9, 4, 5, 4, 1, NULL, 20250901, 20250906, 20250911, 5, 70, 350, 0.0, 73.5, 423.5, 300.0, 'held', 0.0, 0.0, 'active', '2025-07-05 12:00:00'),
  (89, 'RB000089', 40, 10, 5, 1, 5, 2, NULL, 20250901, 20250907, 20250913, 6, 75, 450, 0.0, 94.5, 544.5, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-04 12:00:00'),
  (90, 'RB000090', 41, 11, 1, 2, 1, 3, NULL, 20250901, 20250908, 20250915, 7, 80, 560, 0.0, 117.6, 677.6, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-03 12:00:00'),
  (91, 'RB000091', 42, 12, 2, 3, 2, 4, 2, 20250901, 20250909, 20250917, 8, 55, 440, 25.0, 87.15, 502.15, 300.0, 'released', 0.0, 0.0, 'completed', '2025-07-02 12:00:00'),
  (92, 'RB000092', 43, 13, 3, 4, 3, 1, NULL, 20250901, 20250910, 20250919, 9, 92, 828, 0.0, 173.88, 1001.88, 500.0, 'released', 0.0, 0.0, 'completed', '2025-07-01 12:00:00'),
  (93, 'RB000093', 44, 14, 4, 5, 4, 2, NULL, 20250901, 20250911, 20250921, 10, 99, 990, 0.0, 207.9, 1197.9, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-30 12:00:00'),
  (94, 'RB000094', 45, 15, 5, 1, 5, 3, NULL, 20250901, 20250912, 20250923, 11, 106, 1166, 0.0, 244.86, 1410.86, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-29 12:00:00'),
  (95, 'RB000095', 46, 16, 1, 2, 1, 4, NULL, 20250901, 20250913, 20250925, 12, 113, 1356, 0.0, 284.76, 1640.76, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-28 12:00:00'),
  (96, 'RB000096', 47, 17, 2, 3, 2, 1, NULL, 20250901, 20250914, 20250927, 13, 120, 1560, 0.0, 327.6, 1887.6, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-27 12:00:00'),
  (97, 'RB000097', 48, 18, 3, 4, 3, 2, NULL, 20250901, 20250915, 20250929, 14, 85, 1190, 0.0, 249.9, 1439.9, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-26 12:00:00'),
  (98, 'RB000098', 49, 19, 4, 5, 4, 3, 3, 20250915, 20250916, 20250917, 1, 92, 92, 13.8, 16.42, 94.62, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-25 12:00:00'),
  (99, 'RB000099', 50, 20, 5, 1, 5, 4, NULL, 20250915, 20250917, 20250919, 2, 99, 198, 0.0, 41.58, 239.58, 500.0, 'held', 0.0, 0.0, 'no_show', '2025-06-24 12:00:00'),
  (100, 'RB000100', 1, 1, 1, 2, 1, 1, NULL, 20250915, 20250918, 20250921, 3, 60, 180, 0.0, 37.8, 217.8, 300.0, 'held', 0.0, 0.0, 'cancelled', '2025-06-23 12:00:00'),
  (101, 'RB000101', 2, 2, 2, 3, 2, 2, NULL, 20250915, 20250919, 20250923, 4, 65, 260, 0.0, 54.6, 314.6, 300.0, 'released', 0.0, 0.0, 'completed', '2025-06-22 12:00:00'),
  (102, 'RB000102', 3, 3, 3, 4, 3, 3, NULL, 20250915, 20250920, 20250925, 5, 70, 350, 0.0, 73.5, 423.5, 300.0, 'partially_used', 45.0, 0.0, 'completed', '2025-06-21 12:00:00'),
  (103, 'RB000103', 4, 4, 4, 5, 4, 4, NULL, 20250604, 20250610, 20250616, 6, 75, 450, 0.0, 94.5, 544.5, 300.0, 'released', 0.0, 0.0, 'completed', '2025-06-20 12:00:00'),
  (104, 'RB000104', 5, 5, 5, 1, 5, 1, NULL, 20250604, 20250611, 20250618, 7, 80, 560, 0.0, 117.6, 677.6, 300.0, 'released', 0.0, 0.0, 'completed', '2025-06-19 12:00:00'),
  (105, 'RB000105', 6, 6, 1, 2, 1, 2, 1, 20250604, 20250612, 20250620, 8, 55, 440, 44.0, 83.16, 479.16, 300.0, 'released', 0.0, 0.0, 'completed', '2025-06-18 12:00:00'),
  (106, 'RB000106', 7, 7, 2, 3, 2, 3, NULL, 20250604, 20250613, 20250622, 9, 60, 540, 0.0, 113.4, 653.4, 300.0, 'released', 0.0, 0.0, 'completed', '2025-06-17 12:00:00'),
  (107, 'RB000107', 8, 8, 3, 4, 3, 4, NULL, 20250604, 20250614, 20250624, 10, 65, 650, 0.0, 136.5, 786.5, 300.0, 'released', 0.0, 0.0, 'completed', '2025-06-16 12:00:00'),
  (108, 'RB000108', 9, 9, 4, 5, 4, 1, NULL, 20250604, 20250615, 20250626, 11, 70, 770, 0.0, 161.7, 931.7, 300.0, 'released', 0.0, 0.0, 'completed', '2025-06-15 12:00:00'),
  (109, 'RB000109', 10, 10, 5, 1, 5, 2, NULL, 20250604, 20250616, 20250628, 12, 75, 900, 0.0, 189.0, 1089.0, 300.0, 'released', 0.0, 0.0, 'completed', '2025-06-14 12:00:00'),
  (110, 'RB000110', 11, 11, 1, 2, 1, 3, NULL, 20250604, 20250617, 20250630, 13, 80, 1040, 0.0, 218.4, 1258.4, 300.0, 'held', 0.0, 0.0, 'active', '2025-06-13 12:00:00'),
  (111, 'RB000111', 12, 12, 2, 3, 2, 4, NULL, 20250604, 20250618, 20250702, 14, 55, 770, 0.0, 161.7, 931.7, 300.0, 'released', 0.0, 0.0, 'completed', '2025-06-12 12:00:00'),
  (112, 'RB000112', 13, 13, 3, 4, 3, 1, 2, 20250618, 20250619, 20250620, 1, 92, 92, 25.0, 14.07, 81.07, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-11 12:00:00'),
  (113, 'RB000113', 14, 14, 4, 5, 4, 2, NULL, 20250618, 20250620, 20250622, 2, 99, 198, 0.0, 41.58, 239.58, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-10 12:00:00'),
  (114, 'RB000114', 15, 15, 5, 1, 5, 3, NULL, 20250618, 20250621, 20250624, 3, 106, 318, 0.0, 66.78, 384.78, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-09 12:00:00'),
  (115, 'RB000115', 16, 16, 1, 2, 1, 4, NULL, 20250618, 20250622, 20250626, 4, 113, 452, 0.0, 94.92, 546.92, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-08 12:00:00'),
  (116, 'RB000116', 17, 17, 2, 3, 2, 1, NULL, 20250618, 20250623, 20250628, 5, 120, 600, 0.0, 126.0, 726.0, 500.0, 'partially_used', 0.0, 90.0, 'completed', '2025-06-07 12:00:00'),
  (117, 'RB000117', 18, 18, 3, 4, 3, 2, NULL, 20250618, 20250624, 20250630, 6, 85, 510, 0.0, 107.1, 617.1, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-06 12:00:00'),
  (118, 'RB000118', 19, 19, 4, 5, 4, 3, NULL, 20250618, 20250625, 20250702, 7, 92, 644, 0.0, 135.24, 779.24, 500.0, 'released', 0.0, 0.0, 'completed', '2025-06-05 12:00:00'),
  (119, 'RB000119', 20, 20, 5, 1, 5, 4, 3, 20250618, 20250626, 20250704, 8, 99, 792, 118.8, 141.37, 814.57, 500.0, 'partially_used', 115.0, 0.0, 'completed', '2025-06-04 12:00:00'),
  (120, 'RB000120', 21, 1, 1, 2, 1, 1, NULL, 20250618, 20250627, 20250706, 9, 60, 540, 0.0, 113.4, 653.4, 300.0, 'held', 0.0, 0.0, 'cancelled', '2025-06-03 12:00:00'),
  (121, 'RB000121', 22, 2, 2, 3, 2, 2, NULL, 20250618, 20250628, 20250708, 10, 65, 650, 0.0, 136.5, 786.5, 300.0, 'held', 0.0, 0.0, 'active', '2025-06-02 12:00:00'),
  (122, 'RB000122', 23, 3, 3, 4, 3, 3, NULL, 20250618, 20250629, 20250710, 11, 70, 770, 0.0, 161.7, 931.7, 300.0, 'released', 0.0, 0.0, 'completed', '2025-06-01 12:00:00'),
  (123, 'RB000123', 24, 4, 4, 5, 4, 4, NULL, 20250618, 20250630, 20250712, 12, 75, 900, 0.0, 189.0, 1089.0, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-31 12:00:00'),
  (124, 'RB000124', 25, 5, 5, 1, 5, 1, NULL, 20250618, 20250701, 20250714, 13, 80, 1040, 0.0, 218.4, 1258.4, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-30 12:00:00'),
  (125, 'RB000125', 26, 6, 1, 2, 1, 2, NULL, 20250618, 20250702, 20250716, 14, 55, 770, 0.0, 161.7, 931.7, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-29 12:00:00'),
  (126, 'RB000126', 27, 7, 2, 3, 2, 3, 1, 20250702, 20250703, 20250704, 1, 60, 60, 6.0, 11.34, 65.34, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-28 12:00:00'),
  (127, 'RB000127', 28, 8, 3, 4, 3, 4, NULL, 20250702, 20250704, 20250706, 2, 65, 130, 0.0, 27.3, 157.3, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-27 12:00:00'),
  (128, 'RB000128', 29, 9, 4, 5, 4, 1, NULL, 20250702, 20250705, 20250708, 3, 70, 210, 0.0, 44.1, 254.1, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-26 12:00:00'),
  (129, 'RB000129', 30, 10, 5, 1, 5, 2, NULL, 20250702, 20250706, 20250710, 4, 75, 300, 0.0, 63.0, 363.0, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-25 12:00:00'),
  (130, 'RB000130', 31, 11, 1, 2, 1, 3, NULL, 20250702, 20250707, 20250712, 5, 80, 400, 0.0, 84.0, 484.0, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-24 12:00:00'),
  (131, 'RB000131', 32, 12, 2, 3, 2, 4, NULL, 20250702, 20250708, 20250714, 6, 55, 330, 0.0, 69.3, 399.3, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-23 12:00:00'),
  (132, 'RB000132', 33, 13, 3, 4, 3, 1, NULL, 20250702, 20250709, 20250716, 7, 92, 644, 0.0, 135.24, 779.24, 500.0, 'held', 0.0, 0.0, 'no_show', '2025-05-22 12:00:00'),
  (133, 'RB000133', 34, 14, 4, 5, 4, 2, 2, 20250702, 20250710, 20250718, 8, 99, 792, 25.0, 161.07, 928.07, 500.0, 'released', 0.0, 0.0, 'completed', '2025-05-21 12:00:00'),
  (134, 'RB000134', 35, 15, 5, 1, 5, 3, NULL, 20250702, 20250711, 20250720, 9, 106, 954, 0.0, 200.34, 1154.34, 500.0, 'released', 0.0, 0.0, 'completed', '2025-05-20 12:00:00'),
  (135, 'RB000135', 36, 16, 1, 2, 1, 4, NULL, 20250702, 20250712, 20250722, 10, 113, 1130, 0.0, 237.3, 1367.3, 500.0, 'released', 0.0, 0.0, 'completed', '2025-05-19 12:00:00'),
  (136, 'RB000136', 37, 17, 2, 3, 2, 1, NULL, 20250702, 20250713, 20250724, 11, 120, 1320, 0.0, 277.2, 1597.2, 500.0, 'partially_used', 80.0, 0.0, 'completed', '2025-05-18 12:00:00'),
  (137, 'RB000137', 38, 18, 3, 4, 3, 2, NULL, 20250702, 20250714, 20250726, 12, 85, 1020, 0.0, 214.2, 1234.2, 500.0, 'released', 0.0, 0.0, 'completed', '2025-05-17 12:00:00'),
  (138, 'RB000138', 39, 19, 4, 5, 4, 3, NULL, 20250702, 20250715, 20250728, 13, 92, 1196, 0.0, 251.16, 1447.16, 500.0, 'released', 0.0, 0.0, 'completed', '2025-05-16 12:00:00'),
  (139, 'RB000139', 40, 20, 5, 1, 5, 4, NULL, 20250702, 20250716, 20250730, 14, 99, 1386, 0.0, 291.06, 1677.06, 500.0, 'released', 0.0, 0.0, 'completed', '2025-05-15 12:00:00'),
  (140, 'RB000140', 41, 1, 1, 2, 1, 1, 3, 20250716, 20250717, 20250718, 1, 60, 60, 9.0, 10.71, 61.71, 300.0, 'held', 0.0, 0.0, 'cancelled', '2025-05-14 12:00:00'),
  (141, 'RB000141', 42, 2, 2, 3, 2, 2, NULL, 20250716, 20250718, 20250720, 2, 65, 130, 0.0, 27.3, 157.3, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-13 12:00:00'),
  (142, 'RB000142', 43, 3, 3, 4, 3, 3, NULL, 20250716, 20250719, 20250722, 3, 70, 210, 0.0, 44.1, 254.1, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-12 12:00:00'),
  (143, 'RB000143', 44, 4, 4, 5, 4, 4, NULL, 20250716, 20250720, 20250724, 4, 75, 300, 0.0, 63.0, 363.0, 300.0, 'held', 0.0, 0.0, 'active', '2025-05-11 12:00:00'),
  (144, 'RB000144', 45, 5, 5, 1, 5, 1, NULL, 20250716, 20250721, 20250726, 5, 80, 400, 0.0, 84.0, 484.0, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-10 12:00:00'),
  (145, 'RB000145', 46, 6, 1, 2, 1, 2, NULL, 20250716, 20250722, 20250728, 6, 55, 330, 0.0, 69.3, 399.3, 300.0, 'partially_used', 0.0, 90.0, 'completed', '2025-05-09 12:00:00'),
  (146, 'RB000146', 47, 7, 2, 3, 2, 3, NULL, 20250716, 20250723, 20250730, 7, 60, 420, 0.0, 88.2, 508.2, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-08 12:00:00'),
  (147, 'RB000147', 48, 8, 3, 4, 3, 4, 1, 20250716, 20250724, 20250801, 8, 65, 520, 52.0, 98.28, 566.28, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-07 12:00:00'),
  (148, 'RB000148', 49, 9, 4, 5, 4, 1, NULL, 20250716, 20250725, 20250803, 9, 70, 630, 0.0, 132.3, 762.3, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-06 12:00:00'),
  (149, 'RB000149', 50, 10, 5, 1, 5, 2, NULL, 20250716, 20250726, 20250805, 10, 75, 750, 0.0, 157.5, 907.5, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-05 12:00:00'),
  (150, 'RB000150', 1, 11, 1, 2, 1, 3, NULL, 20250716, 20250727, 20250807, 11, 80, 880, 0.0, 184.8, 1064.8, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-04 12:00:00'),
  (151, 'RB000151', 2, 12, 2, 3, 2, 4, NULL, 20250716, 20250728, 20250809, 12, 55, 660, 0.0, 138.6, 798.6, 300.0, 'released', 0.0, 0.0, 'completed', '2025-05-03 12:00:00'),
  (152, 'RB000152', 3, 13, 3, 4, 3, 1, NULL, 20250716, 20250729, 20250811, 13, 92, 1196, 0.0, 251.16, 1447.16, 500.0, 'released', 0.0, 0.0, 'completed', '2025-05-02 12:00:00'),
  (153, 'RB000153', 4, 14, 4, 5, 4, 2, NULL, 20250716, 20250730, 20250813, 14, 99, 1386, 0.0, 291.06, 1677.06, 500.0, 'partially_used', 45.0, 0.0, 'completed', '2025-05-01 12:00:00'),
  (154, 'RB000154', 5, 15, 5, 1, 5, 3, 2, 20250730, 20250731, 20250801, 1, 106, 106, 25.0, 17.01, 98.01, 500.0, 'held', 0.0, 0.0, 'active', '2025-04-30 12:00:00'),
  (155, 'RB000155', 6, 16, 1, 2, 1, 4, NULL, 20250730, 20250801, 20250803, 2, 113, 226, 0.0, 47.46, 273.46, 500.0, 'released', 0.0, 0.0, 'completed', '2025-04-29 12:00:00'),
  (156, 'RB000156', 7, 17, 2, 3, 2, 1, NULL, 20250730, 20250802, 20250805, 3, 120, 360, 0.0, 75.6, 435.6, 500.0, 'released', 0.0, 0.0, 'completed', '2025-04-28 12:00:00'),
  (157, 'RB000157', 8, 18, 3, 4, 3, 2, NULL, 20250730, 20250803, 20250807, 4, 85, 340, 0.0, 71.4, 411.4, 500.0, 'released', 0.0, 0.0, 'completed', '2025-04-27 12:00:00'),
  (158, 'RB000158', 9, 19, 4, 5, 4, 3, NULL, 20250730, 20250804, 20250809, 5, 92, 460, 0.0, 96.6, 556.6, 500.0, 'released', 0.0, 0.0, 'completed', '2025-04-26 12:00:00'),
  (159, 'RB000159', 10, 20, 5, 1, 5, 4, NULL, 20250730, 20250805, 20250811, 6, 99, 594, 0.0, 124.74, 718.74, 500.0, 'released', 0.0, 0.0, 'completed', '2025-04-25 12:00:00'),
  (160, 'RB000160', 11, 1, 1, 2, 1, 1, NULL, 20250730, 20250806, 20250813, 7, 60, 420, 0.0, 88.2, 508.2, 300.0, 'held', 0.0, 0.0, 'cancelled', '2025-04-24 12:00:00');

COMMIT;

-- Ejemplos de conversion (CAST) y funciones de fecha

-- date_key (YYYYMMDD) -> date (PostgreSQL)
SELECT date_key, TO_DATE(date_key::TEXT, 'YYYYMMDD') AS as_date
FROM dim_calendar
ORDER BY date_key
LIMIT 5;

-- Diferencia en dias entre pickup y return (validacion rapida)
SELECT
  rental_id,
  (rcal.date_value - pcal.date_value) AS days_between
FROM fact_rental fr
JOIN dim_calendar pcal ON pcal.date_key = fr.pickup_date_key
JOIN dim_calendar rcal ON rcal.date_key = fr.return_date_key
ORDER BY rental_id
LIMIT 5;

-- Ejemplo requerido: UPDATE (con ROLLBACK para no ensuciar datos)

BEGIN;
-- Si una moto tuvo incidencias (daños o multas), la marcamos en maintenance.
UPDATE dim_motorcycle
SET status = 'maintenance'
WHERE motorcycle_id IN (
  SELECT DISTINCT motorcycle_id
  FROM fact_rental
  WHERE damage_fee > 0 OR traffic_fines > 0
);

-- Verificacion
SELECT status, COUNT(*) FROM dim_motorcycle GROUP BY status ORDER BY status;
ROLLBACK;

-- Ejemplo requerido: DELETE (con ROLLBACK para no perder historial)

BEGIN;
-- Caso tipico: se podria borrar una reserva cancelada de pruebas. Aqui solo se demuestra.
DELETE FROM fact_rental
WHERE status = 'cancelled';

-- Cuantas quedarian
SELECT COUNT(*) AS rentals_remaining FROM fact_rental;
ROLLBACK;

-- Ejemplo requerido: INSERT adicional (también incluye ROLLBACK)

BEGIN;
-- Insertamos una promo temporal para una campaña.
INSERT INTO dim_promo (promo_id, code, discount_type, discount_value, description)
VALUES (999, 'DEMO5', 'percent', 5.0, 'Promo de demostracion (sin presistir)');
SELECT * FROM dim_promo WHERE promo_id = 999;
ROLLBACK;
